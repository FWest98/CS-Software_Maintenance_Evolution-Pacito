Pattern changes caused by commit: d33e2be8b4b41c18658c1803f29aa9e15afc20d2

From: Decorator-1
To:   Decorator-0

From: Mediator-3
To:   Mediator-2


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-4607.txt 

commit d33e2be8b4b41c18658c1803f29aa9e15afc20d2
Author: Sylvain Lebresne <slebresne@apache.org>

    Refuse counter write at CL.ANY
    patch by slebresne; reviewed by jbellis for CASSANDRA-2990



==================================
 Issue CASSANDRA-2990 Description 
=======================================

Project: Cassandra
-----------------

-----------------
Title: [CASSANDRA-2990] We should refuse query for counters at CL.ANY
-----------------

-----------------
Summary: We should refuse query for counters at CL.ANY
-----------------

-----------------
Issue type: Bug
-----------------

-----------------
Current status: Resolved
-----------------

-----------------
Created at: Wed, 3 Aug 2011 18:10:50 +0000
-----------------

-----------------
Resolved at: Tue, 9 Aug 2011 20:27:08 +0000
-----------------

-----------------
Assigned to: Sylvain Lebresne
-----------------

-----------------
Description: 

We currently do not reject writes for counters at CL.ANY, even though this is not
supported (and rightly so).
 

-----------------

-----------------
Comments: 

New Comment: 
A few days ago, you said, "A counter mutation only live enough so that it is applied to
the first replica. Once this is done, a <b>row</b> mutation is generated for the other
replica. That second mutation can be hinted. But that is a row mutation, so there should
be no special casing at all for that."Why can't we hint the first replica? 


New Comment: 
<blockquote>Why can't we hint the first replica?</blockquote>Well, actually I think we
could. Or at least if we cannot I forgot why. We would need to be sure we never replay an
hint twice though, which I'm not sure is a guarantee right now. Also, we can only make
this if what we store as a hint is the serialized mutation (in this case, the serialized
CounterMutation): we can't apply the CounterMutation on a non-replica (partly because that
would potentially increase the counter context too much, partly because counter remove
suck, which would probably be a problem at some point).So it should be doable, but it's a
bit of work. 


New Comment: 
Okay, +1 on making the validation match what is actually currently supported (no ANY for
counters), although I'd change "not supported" to "not yet supported."We can deal w/
adding ANY support if and when someone actually needs it. 


New Comment: 
Committed with message tweak 


