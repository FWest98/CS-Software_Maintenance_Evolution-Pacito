Pattern changes caused by commit: 6e325c5ab3bddec33a3083bf6e079e218e460d59

From: Decorator-1
To:   Decorator-0

From: Flyweight-4
To:   Flyweight-5

From: Mediator-2
To:   Mediator-1

From: Strategy-1
To:   Strategy-0


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-4763.txt 

commit 6e325c5ab3bddec33a3083bf6e079e218e460d59
Author: T Jake Luciani <jake@apache.org>

    Fix div by zero error take two
    patch by tjake; reviewed by jbellis for CASSANDRA-3076



==================================
 Issue CASSANDRA-3076 Description 
=======================================

Project: Cassandra
-----------------

-----------------
Title: [CASSANDRA-3076] AssertionError in new GCInspector log
-----------------

-----------------
Summary: AssertionError in new GCInspector log
-----------------

-----------------
Issue type: Bug
-----------------

-----------------
Current status: Resolved
-----------------

-----------------
Created at: Thu, 25 Aug 2011 14:26:56 +0000
-----------------

-----------------
Resolved at: Wed, 31 Aug 2011 20:05:02 +0000
-----------------

-----------------
Assigned to: T Jake Luciani
-----------------

-----------------
Description: 

Small regression from <a href="https://issues.apache.org/jira/browse/CASSANDRA-2868"
title="Native Memory Leak" class="issue-link"
data-issue-key="CASSANDRA-2868"><del>CASSANDRA-2868</del></a>
 

-----------------

-----------------
Comments: 

New Comment: 
<div class="code panel" style="border-width: 1px;"><div class="codeContent
panelContent"><pre class="code-java">    [junit] ERROR 10:20:16,755 Fatal exception in
thread <span class="code-object">Thread</span>[ScheduledTasks:1,5,main]    [junit]
java.lang.AssertionError    [junit] 	at
org.apache.cassandra.service.GCInspector.logGCResults(GCInspector.java:110)    [junit] 	at
org.apache.cassandra.service.GCInspector.access$000(GCInspector.java:41)    [junit] 	at
org.apache.cassandra.service.GCInspector$1.run(GCInspector.java:85)    [junit] 	at
java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)    [junit] 	at
java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317)    [junit] 	at
java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150)    [junit] 	at
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98)
   [junit] 	at
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:180)
   [junit] 	at
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:204)
   [junit] 	at
java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)   
[junit] 	at
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)    [junit]
	at java.lang.<span class="code-object">Thread</span>.run(<span
class="code-object">Thread</span>.java:680)    [junit] ------------- ----------------
---------------</pre></div></div> 


New Comment: 
The assert is basically saying "if total gc time has increased, count should have
increased as well."If that's valid, then the "if (previousTotal.equals(total)) continue"
check should handle this.  If it's not, we should probably remove the assert entirely. 


New Comment: 
Right, I think it's likely a OSX lion thing.  Removing the assert works for me. 


New Comment: 
ok, done in 0.7.  (Brandon already did that in 0.8 in r1161167.) 


New Comment: 
New error due to the count being zero. The original patch fixes this.<div class="code
panel" style="border-width: 1px;"><div class="codeContent panelContent"><pre
class="code-java">  [junit] ERROR 09:06:26,417 Fatal exception in thread <span
class="code-object">Thread</span>[ScheduledTasks:1,5,main]    [junit]
java.lang.ArithmeticException: / by zero    [junit] 	at
org.apache.cassandra.service.GCInspector.logGCResults(GCInspector.java:117)    [junit] 	at
org.apache.cassandra.service.GCInspector.access$000(GCInspector.java:41)    [junit] 	at
org.apache.cassandra.service.GCInspector$1.run(GCInspector.java:85)    [junit] 	at
java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)    [junit] 	at
java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317)    [junit] 	at
java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150)    [junit] 	at
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98)
   [junit] 	at
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:180)
   [junit] 	at
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:204)
   [junit] 	at
java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)   
[junit] 	at
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)    [junit]
	at java.lang.<span class="code-object">Thread</span>.run(<span
class="code-object">Thread</span>.java:680)</pre></div></div> 


New Comment: 
+1 if you fix the spacing then 


New Comment: 
committed 


New Comment: 
Integrated in Cassandra-0.7 #546 (See <a
href="https://builds.apache.org/job/Cassandra-0.7/546/" class="external-link"
rel="nofollow">https://builds.apache.org/job/Cassandra-0.7/546/</a>)<br/>    Fix div by
zero error<br/>patch by tjake; reviewed by jbellis for <a
href="https://issues.apache.org/jira/browse/CASSANDRA-3076" title="AssertionError in new
GCInspector log" class="issue-link"
data-issue-key="CASSANDRA-3076"><del>CASSANDRA-3076</del></a>jake : <a
href="http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;view=rev&amp;rev=1163234"
class="external-link"
rel="nofollow">http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;view=rev&amp;rev=1163234</a><br/>Files
:
<ul>	<li>/cassandra/branches/cassandra-0.7/src/java/org/apache/cassandra/service/GCInspector.java</li></ul> 


New Comment: 
Still seeing this post-patch in trunk:<div class="preformatted panel" style="border-width:
1px;"><div class="preformattedContent panelContent"><pre>    [junit] ERROR 14:23:17,606
Fatal exception in thread Thread[ScheduledTasks:1,5,main]    [junit]
java.lang.ArithmeticException: / by zero    [junit] 	at
org.apache.cassandra.service.GCInspector.logGCResults(GCInspector.java:119)    [junit] 	at
org.apache.cassandra.service.GCInspector.access$000(GCInspector.java:41)    [junit] 	at
org.apache.cassandra.service.GCInspector$1.run(GCInspector.java:85)    [junit] 	at
java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)    [junit] 	at
java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317)    [junit] 	at
java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150)    [junit] 	at
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98)
   [junit] 	at
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:180)
   [junit] 	at
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:204)
   [junit] 	at
java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)   
[junit] 	at
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)    [junit]
	at java.lang.Thread.run(Thread.java:680)</pre></div></div> 


New Comment: 
+1 new patch 


