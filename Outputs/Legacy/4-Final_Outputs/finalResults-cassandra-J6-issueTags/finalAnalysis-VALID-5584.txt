Pattern changes caused by commit: 09ac4bc05bbc2ef7f0fb68895fafb858ff7cfeb0

From: Facade-1
To:   Facade-0


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-5584.txt 

commit 09ac4bc05bbc2ef7f0fb68895fafb858ff7cfeb0
Author: Pavel Yaskevich <xedin@apache.org>

    fix compression "chunk_length_kb" option to set correct kb value for thrift/avro
    patch by Sylvain Lebresne; reviewed by Pavel Yaskevich for CASSANDRA-3558



==================================
 Issue CASSANDRA-3558 Description 
=======================================

Project: Cassandra
-----------------

-----------------
Title: [CASSANDRA-3558] Compression chunk_length_kb is not correctly returned for thrift/avro
-----------------

-----------------
Summary: Compression chunk_length_kb is not correctly returned for thrift/avro
-----------------

-----------------
Issue type: Bug
-----------------

-----------------
Current status: Resolved
-----------------

-----------------
Created at: Fri, 2 Dec 2011 11:59:41 +0000
-----------------

-----------------
Resolved at: Tue, 6 Dec 2011 12:31:40 +0000
-----------------

-----------------
Assigned to: Sylvain Lebresne
-----------------

-----------------
Description: 

<a href="https://issues.apache.org/jira/browse/CASSANDRA-3492" title="Compression option
chunk_length is not converted into KB as it should" class="issue-link"
data-issue-key="CASSANDRA-3492"><del>CASSANDRA-3492</del></a> fixed the interpretation of
chunk_length_kb as a size in bytes but infortunately forgot to convert it back to kb when
returning it for thrift/avro. In particular, this means that a <tt>describe cf</tt> would
return things like <tt>chunk_length_kb: 65535</tt>.

I'm afraid that because migration
uses Avro this is kind of a problem. One may have to issue an 'update column family' with
the right chunk_length_kb to be sure to be in a safe place.
 

-----------------

-----------------
Comments: 

New Comment: 
Fix attached. I've added a test for this in the distributed tests (at <a
href="https://github.com/riptano/cassandra-dtest" class="external-link"
rel="nofollow">https://github.com/riptano/cassandra-dtest</a>).We could have a unit test
for this but without <a href="https://issues.apache.org/jira/browse/CASSANDRA-3559"
title="CFMetaData conversions to Thrift/Native schema should be inverse one of the other"
class="issue-link" data-issue-key="CASSANDRA-3559"><del>CASSANDRA-3559</del></a>, it's
more pain that it should be. 


