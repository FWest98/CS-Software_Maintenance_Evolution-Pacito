Pattern changes caused by commit: 8a69a33dd91a58360f76a483984360bb808fc4e4

From: Decorator-1
To:   Decorator-0

From: Flyweight-4
To:   Flyweight-5

From: Strategy-1
To:   Strategy-0


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-5289.txt 

commit 8a69a33dd91a58360f76a483984360bb808fc4e4
Author: Sylvain Lebresne <slebresne@apache.org>

    Don't expire counter tombstones after streaming
    patch by slebresne; reviewed by jbellis for CASSANDRA-3394



==================================
 Issue CASSANDRA-3394 Description 
=======================================

Project: Cassandra
-----------------

-----------------
Title: [CASSANDRA-3394] AssertionError in PrecompactedRow.write via CommutativeRowIndexer during bootstrap
-----------------

-----------------
Summary: AssertionError in PrecompactedRow.write via CommutativeRowIndexer during bootstrap
-----------------

-----------------
Issue type: Bug
-----------------

-----------------
Current status: Resolved
-----------------

-----------------
Created at: Fri, 21 Oct 2011 17:09:33 +0000
-----------------

-----------------
Resolved at: Fri, 21 Oct 2011 19:43:15 +0000
-----------------

-----------------
Assigned to: Sylvain Lebresne
-----------------

-----------------
Description: 
<div class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent
panelContent"><pre>ERROR [CompactionExecutor:5] 2011-10-21 15:48:16,138
AbstractCassandraDaemon.java (line 139) Fatal exception in thread
Thread[CompactionExecutor:5,1,main]java.lang.AssertionError        at
org.apache.cassandra.db.compaction.PrecompactedRow.write(PrecompactedRow.java:107)       
at
org.apache.cassandra.io.sstable.SSTableWriter$CommutativeRowIndexer.doIndexing(SSTableWriter.java:514)
       at
org.apache.cassandra.io.sstable.SSTableWriter$RowIndexer.index(SSTableWriter.java:359)    
   at org.apache.cassandra.io.sstable.SSTableWriter$Builder.build(SSTableWriter.java:314) 
      at
org.apache.cassandra.db.compaction.CompactionManager$9.call(CompactionManager.java:1118)  
     at
org.apache.cassandra.db.compaction.CompactionManager$9.call(CompactionManager.java:1109)  
     at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)        at
java.util.concurrent.FutureTask.run(FutureTask.java:138)        at
java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)       
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)       
at java.lang.Thread.run(Thread.java:662)</pre></div></div>
<tt>&lt;sylvain&gt; The bug is
that the compacted row was gcing <b>every</b> tombstones instead of none.</tt>
 

-----------------

-----------------
Comments: 

New Comment: 
Note: attached patch is for 0.8. The fix for 1.0.1 is the same but that line is now in
IncomingStreamReader. I'll handle that during merge once this is reviewed. 


New Comment: 
+1 


New Comment: 
Committed 


