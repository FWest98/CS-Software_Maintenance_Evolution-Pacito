Pattern changes caused by commit: a9f031b1a579956eba1f04c15cd98777a7eee86f

From: Decorator-1
To:   Decorator-0

From: Mediator-3
To:   Mediator-2


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-4640.txt 

commit a9f031b1a579956eba1f04c15cd98777a7eee86f
Author: Jonathan Ellis <jbellis@apache.org>

    fix string formatting bug, and provide human-readable keys where possible
    patch by jbellis; tested by Cathy Daw for CASSANDRA-3022



==================================
 Issue CASSANDRA-3022 Description 
=======================================

Project: Cassandra
-----------------

-----------------
Title: [CASSANDRA-3022] Failures in cassandra long test: LongCompactionSpeedTest
-----------------

-----------------
Summary: Failures in cassandra long test: LongCompactionSpeedTest
-----------------

-----------------
Issue type: Bug
-----------------

-----------------
Current status: Resolved
-----------------

-----------------
Created at: Fri, 12 Aug 2011 19:44:14 +0000
-----------------

-----------------
Resolved at: Sat, 13 Aug 2011 06:06:10 +0000
-----------------

-----------------
Assigned to: Jonathan Ellis
-----------------

-----------------
Description: 

<b>The failing test case</b>
<div class="code panel" style="border-width: 1px;"><div
class="codeContent panelContent"><pre class="code-java">    [junit] Testsuite:
org.apache.cassandra.db.compaction.LongCompactionSpeedTest</pre></div></div>
<b>The
following error is repeated in the console output</b>
<div class="code panel"
style="border-width: 1px;"><div class="codeContent panelContent"><pre class="code-java">  
 [junit] ERROR 04:02:20,654 Error in ThreadPoolExecutor    [junit]
java.util.MissingFormatArgumentException: Format specifier <span
class="code-quote">'s'</span>    [junit] 	at
java.util.Formatter.format(Formatter.java:2432)    [junit] 	at
java.util.Formatter.format(Formatter.java:2367)    [junit] 	at java.lang.<span
class="code-object">String</span>.format(<span
class="code-object">String</span>.java:2769)    [junit] 	at
org.apache.cassandra.db.compaction.CompactionController.getCompactedRow(CompactionController.java:136)
   [junit] 	at
org.apache.cassandra.db.compaction.CompactionIterator.getReduced(CompactionIterator.java:123)
   [junit] 	at
org.apache.cassandra.db.compaction.CompactionIterator.getReduced(CompactionIterator.java:43)
   [junit] 	at
org.apache.cassandra.utils.ReducingIterator.computeNext(ReducingIterator.java:74)   
[junit] 	at
com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:140)   
[junit] 	at com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:135) 
  [junit] 	at
org.apache.commons.collections.iterators.FilterIterator.setNextObject(FilterIterator.java:183)
   [junit] 	at
org.apache.commons.collections.iterators.FilterIterator.hasNext(FilterIterator.java:94)   
[junit] 	at
org.apache.cassandra.db.compaction.CompactionManager.doCompactionWithoutSizeEstimation(CompactionManager.java:559)
   [junit] 	at
org.apache.cassandra.db.compaction.CompactionManager.doCompaction(CompactionManager.java:506)
   [junit] 	at
org.apache.cassandra.db.compaction.CompactionManager$1.call(CompactionManager.java:141)   
[junit] 	at
org.apache.cassandra.db.compaction.CompactionManager$1.call(CompactionManager.java:107)   
[junit] 	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)    [junit]
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)    [junit] 	at
java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)   
[junit] 	at
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)    [junit]
	at java.lang.<span class="code-object">Thread</span>.run(<span
class="code-object">Thread</span>.java:662)</pre></div></div>
*Cassandra Revision List at
time of failure
<div class="code panel" style="border-width: 1px;"><div class="codeContent
panelContent"><pre class="code-java">Summary* log ks and cf of large rows being compacted
patch by Ryan King; reviewed by jbellis <span class="code-keyword">for</span>
CASSANDRA-3019* revert r1156772* cache invalidate removes saved cache files patch by Ed
Capriolo; reviewed by jbellis <span class="code-keyword">for</span> CASSANDRA-2325* make
sure truncate clears out the commitlog patch by jbellis; reviewed by slebresne <span
class="code-keyword">for</span> CASSANDRA-2950* include column name in validation failure
exceptions patch by jbellis; reviewed by David Allsopp <span
class="code-keyword">for</span> CASSANDRA-2849* fix NPE when encryption_options is
unspecified patch by jbellis; reviewed by brandonwilliams <span
class="code-keyword">for</span> CASSANDRA-3007* update CHANGES* update CHANGESRevision
1156830 by jbellis: log ks and cf of large rows being compactedpatch by Ryan King;
reviewed by jbellis <span class="code-keyword">for</span>
CASSANDRA-3019	/cassandra/branches/cassandra-0.8/src/java/org/apache/cassandra/db/compaction/CompactionController.javaRevision
1156791 by jbellis: revert
r1156772	/cassandra/branches/cassandra-0.8/CHANGES.txt	/cassandra/branches/cassandra-0.8/src/java/org/apache/cassandra/db/ColumnFamilyStore.javaRevision
1156772 by jbellis: cache invalidate removes saved cache filespatch by Ed Capriolo;
reviewed by jbellis <span class="code-keyword">for</span>
CASSANDRA-2325	/cassandra/branches/cassandra-0.8/CHANGES.txt	/cassandra/branches/cassandra-0.8/src/java/org/apache/cassandra/db/ColumnFamilyStore.javaRevision
1156763 by jbellis: make sure truncate clears out the commitlogpatch by jbellis; reviewed
by slebresne <span class="code-keyword">for</span>
CASSANDRA-2950	/cassandra/branches/cassandra-0.8/CHANGES.txt	/cassandra/branches/cassandra-0.8/src/java/org/apache/cassandra/db/SystemTable.java	/cassandra/branches/cassandra-0.8/test/unit/org/apache/cassandra/db/RecoveryManagerTruncateTest.java	/cassandra/branches/cassandra-0.8/src/java/org/apache/cassandra/db/commitlog/CommitLog.java	/cassandra/branches/cassandra-0.8/src/java/org/apache/cassandra/db/ColumnFamilyStore.javaRevision
1156753 by jbellis: include column name in validation failure exceptionspatch by jbellis;
reviewed by David Allsopp <span class="code-keyword">for</span>
CASSANDRA-2849	/cassandra/branches/cassandra-0.8/CHANGES.txt	/cassandra/branches/cassandra-0.8/src/java/org/apache/cassandra/thrift/ThriftValidation.java	/cassandra/branches/cassandra-0.8/src/java/org/apache/cassandra/thrift/CassandraServer.javaRevision
1156749 by jbellis: fix NPE when encryption_options is unspecifiedpatch by jbellis;
reviewed by brandonwilliams <span class="code-keyword">for</span>
CASSANDRA-3007	/cassandra/branches/cassandra-0.8/CHANGES.txt	/cassandra/branches/cassandra-0.8/src/java/org/apache/cassandra/net/MessagingService.javaRevision
1156695 by jbellis: update CHANGES	/cassandra/branches/cassandra-0.8/CHANGES.txtRevision
1156694 by jbellis: update
CHANGES	/cassandra/branches/cassandra-0.8/CHANGES.txt</pre></div></div> 

-----------------

-----------------
Comments: 

New Comment: 
patch to fix, and provide human-readable keys where possible 


New Comment: 
The patch fixed the problem.<div class="code panel" style="border-width: 1px;"><div
class="codeContent panelContent"><pre class="code-java"><span
class="code-object">long</span>-test:     [echo] running <span
class="code-object">long</span> tests    [junit] WARNING: multiple versions of ant
detected in path <span class="code-keyword">for</span> junit     [junit]         
jar:file:/usr/share/ant/lib/ant.jar!/org/apache/tools/ant/Project.class    [junit]     
and
jar:file:/Users/cathy/dev/cassandra-0.8/build/lib/jars/ant-1.6.5.jar!/org/apache/tools/ant/Project.class
   [junit] Testsuite: org.apache.cassandra.db.LongTableTest    [junit] Tests run: 1,
Failures: 0, Errors: 0, Time elapsed: 15.548 sec    [junit]     [junit] Testsuite:
org.apache.cassandra.db.MeteredFlusherTest    [junit] Tests run: 1, Failures: 0, Errors:
0, Time elapsed: 25.154 sec    [junit]     [junit] Testsuite:
org.apache.cassandra.db.compaction.LongCompactionSpeedTest    [junit] Tests run: 6,
Failures: 0, Errors: 0, Time elapsed: 82.062 sec    [junit]     [junit] -------------
Standard Output ---------------    [junit]
org.apache.cassandra.db.compaction.LongCompactionSpeedTest: sstables=2 rowsper=1
colsper=200000: 988 ms    [junit]
org.apache.cassandra.db.compaction.LongCompactionSpeedTest: sstables=2 rowsper=200000
colsper=1: 2751 ms    [junit] org.apache.cassandra.db.compaction.LongCompactionSpeedTest:
sstables=100 rowsper=800 colsper=5: 1281 ms    [junit]
org.apache.cassandra.db.compaction.LongCompactionSpeedTest: sstables=2 rowsper=1
colsper=500000: 10034 ms    [junit]
org.apache.cassandra.db.compaction.LongCompactionSpeedTest: sstables=2 rowsper=500000
colsper=1: 13489 ms    [junit] org.apache.cassandra.db.compaction.LongCompactionSpeedTest:
sstables=100 rowsper=1000 colsper=5: 9982 ms    [junit] ------------- ----------------
---------------    [junit] Testsuite: org.apache.cassandra.utils.LongBloomFilterTest   
[junit] Tests run: 3, Failures: 0, Errors: 0, Time elapsed: 65.727 sec    [junit]    
[junit] Testsuite: org.apache.cassandra.utils.LongLegacyBloomFilterTest    [junit] Tests
run: 3, Failures: 0, Errors: 0, Time elapsed: 42.892 sec    [junit] BUILD
SUCCESSFUL</pre></div></div> 


New Comment: 
committed 


