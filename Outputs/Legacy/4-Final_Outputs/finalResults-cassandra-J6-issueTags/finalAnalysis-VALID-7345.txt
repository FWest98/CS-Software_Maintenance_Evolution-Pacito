Pattern changes caused by commit: 6e1f3a0195b777c9ae79ab89230b67ca20c1adc4

From: Decorator-2
To:   Decorator-1

From: Flyweight-2
To:   Flyweight-1

From: Mediator-3
To:   Mediator-1

From: Strategy-0
To:   Strategy-1


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-7345.txt 

commit 6e1f3a0195b777c9ae79ab89230b67ca20c1adc4
Author: Yuki Morishita <yukim@apache.org>

    Fix NPE when listing directory; patch by yukim reviewed by jbellis for
    CASSANDRA-4572



==================================
 Issue CASSANDRA-4572 Description 
=======================================

Project: Cassandra
-----------------

-----------------
Title: [CASSANDRA-4572] lost+found directory in the data dir causes problems again
-----------------

-----------------
Summary: lost+found directory in the data dir causes problems again
-----------------

-----------------
Issue type: Bug
-----------------

-----------------
Current status: Resolved
-----------------

-----------------
Created at: Thu, 23 Aug 2012 18:08:35 +0000
-----------------

-----------------
Resolved at: Thu, 30 Aug 2012 19:02:06 +0000
-----------------

-----------------
Assigned to: Yuki Morishita
-----------------

-----------------
Description: 

Looks like we've regressed from <a
href="https://issues.apache.org/jira/browse/CASSANDRA-1547" title="lost+found directories
cause problems for cassandra" class="issue-link"
data-issue-key="CASSANDRA-1547"><del>CASSANDRA-1547</del></a> and mounting a fs directly
on the data dir is a problem again.
<div class="preformatted panel" style="border-width:
1px;"><div class="preformattedContent panelContent"><pre>INFO [main] 2012-08-22
23:30:03,710 Directories.java (line 475) Upgrade from pre-1.1 version detected: migrating
sstables to new directory layout ERROR [main] 2012-08-22 23:30:03,712
AbstractCassandraDaemon.java (line 370) Exception encountered during startup              
  java.lang.NullPointerException         at
org.apache.cassandra.db.Directories.migrateSSTables(Directories.java:487)</pre></div></div> 

-----------------

-----------------
Comments: 

New Comment: 
When you do File#listFiles on lost+found directory, it returns null. I believe there are
other cases that it returns null, so attached patch just checks null after File#listFiles
is performed. 


New Comment: 
+1 


