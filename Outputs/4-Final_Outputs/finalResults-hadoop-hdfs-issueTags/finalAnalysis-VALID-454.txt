Pattern changes caused by commit: 58cf512a030e95d69dee238964b1871b3fbd3647

From: Mediator-1
To:   Mediator-0


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-454.txt 

commit 58cf512a030e95d69dee238964b1871b3fbd3647
Author: Dhruba Borthakur <dhruba@apache.org>

    HDFS-1031. Enhance the webUi to list a few of the corrupted files in HDFS.
    (AndrÃ© Orian via dhruba)



==================================
 Issue HDFS-1031 Description 
=======================================

Project: Hadoop HDFS
-----------------

-----------------
Title: [HDFS-1031] Enhance the webUi to list a few of the corrupted files in HDFS
-----------------

-----------------
Summary: Enhance the webUi to list a few of the corrupted files in HDFS
-----------------

-----------------
Issue type: Improvement
-----------------

-----------------
Current status: Closed
-----------------

-----------------
Created at: Tue, 9 Mar 2010 06:51:24 +0000
-----------------

-----------------
Resolved at: Sun, 25 Apr 2010 09:14:24 +0000
-----------------

-----------------
Assigned to: André Oriani
-----------------

-----------------
Description: 

The existing webUI displays something like this:<br/>WARNING : There are about 12 missing
blocks. Please check the log or run fsck. 

It would be nice if we can display the
filenames that have missing blocks. 
 

-----------------

-----------------
Comments: 

New Comment: 
I worry about cluttering up the front page with this info, especially if there are a lot
of files that are broken.  I think it would be good to put this on a secondary page. <span
class="error">&#91;Make it clickable from the error message?&#93;</span> 


New Comment: 
+1 on this idea, also agree with Allen that it should be a linked page. 


New Comment: 
That's the prototype of my solution to this Jira in order to gather requirements and
feedback for a final patch. 


New Comment: 
Upmerged to trunk<br/>Rewrite based on <a
href="https://issues.apache.org/jira/browse/HDFS-1032" title="Extend DFSck with an option
to list corrupt files using API from HDFS-729" class="issue-link"
data-issue-key="HDFS-1032"><del>HDFS-1032</del></a> resolution<br/>Tests added<br/>Asking
for review 


New Comment: 
Hudson failed to add  comment to JIRA , so I am reproducing the output of build  <a
href="http://hudson.zones.apache.org/hudson/view/Hdfs/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/308/"
class="external-link"
rel="nofollow">http://hudson.zones.apache.org/hudson/view/Hdfs/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/308/</a>
here:<div class="code panel" style="border-width: 1px;"><div class="codeContent
panelContent"><pre class="code-java"> [exec] -1 overall.  Here are the results of testing
the latest attachment      [exec]   http:<span
class="code-comment">//issues.apache.org/jira/secure/attachment/12441369/hdfs-1031_aoriani_2.patch</span>
    [exec]   against trunk revision 932036.     [exec]      [exec]     +1 @author.  The
patch does not contain any @author tags.     [exec]      [exec]     +1 tests included. 
The patch appears to include 2 <span class="code-keyword">new</span> or modified tests.   
 [exec]      [exec]     +1 javadoc.  The javadoc tool did not generate any warning
messages.     [exec]      [exec]     +1 javac.  The applied patch does not increase the
total number of javac compiler warnings.     [exec]      [exec]     +1 findbugs.  The
patch does not introduce any <span class="code-keyword">new</span> Findbugs warnings.    
[exec]      [exec]     +1 release audit.  The applied patch does not increase the total
number of release audit warnings.     [exec]      [exec]     -1 core tests.  The patch
failed core unit tests.     [exec]      [exec]     -1 contrib tests.  The patch failed
contrib unit tests.     [exec]      [exec] Test results: http:<span
class="code-comment">//hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/308/testReport/</span>
    [exec] Findbugs warnings: http:<span
class="code-comment">//hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/308/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html</span>
    [exec] Checkstyle results: http:<span
class="code-comment">//hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/308/artifact/trunk/build/test/checkstyle-errors.html</span>
    [exec] Console output: http:<span
class="code-comment">//hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/308/console</span>
    [exec]      [exec] This message is automatically generated.     [exec]      [exec]    
 [exec] ======================================================================     [exec]
======================================================================     [exec]    
Adding comment to Jira.     [exec]
======================================================================     [exec]
======================================================================     [exec]     
[exec]      [exec] Failed to connect to: http:<span
class="code-comment">//issues.apache.org/jira/rpc/soap/jirasoapservice-v2?wsdl</span>    
[exec] Failed to connect to: http:<span
class="code-comment">//issues.apache.org/jira/rpc/soap/jirasoapservice-v2?wsdl</span>    
[exec] Failed to connect to: http:<span
class="code-comment">//issues.apache.org/jira/rpc/soap/jirasoapservice-v2?wsdl</span>    
[exec]   % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current    
[exec]                                  Dload  Upload   Total   Spent    Left  Speed    
[exec]      [exec]   0     0    0     0    0     0      0      0 --:--:-- --:--:--
--:--:--     0  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--    
0     [exec]      [exec]      [exec]
======================================================================     [exec]
======================================================================     [exec]    
Finished build.     [exec]
======================================================================     [exec]
======================================================================     [exec]     
[exec] BUILD
FAILED/grid/0/hudson/hudson-slave/workspace/Hdfs-Patch-h5.grid.sp2.yahoo.net/trunk/build.xml:1198:
exec returned: 2Total time: 210 minutes 25 secondsArchiving artifactsRecording test
resultsDescription set: HDFS-1031Error updating JIRA issues. Saving issues <span
class="code-keyword">for</span> next build.javax.net.ssl.SSLHandshakeException:
sun.security.validator.ValidatorException: PKIX path validation failed:
java.security.cert.CertPathValidatorException: subject/issuer name chaining check
failedSending e-mails to: gkesavan@apache.orgFinished: FAILURE</pre></div></div> 


New Comment: 
The test report (<a
href="http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/308/testReport/"
class="external-link"
rel="nofollow">http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/308/testReport/</a>)
shows only one test failed, not related to code introduced by my patch
Regressionorg.apache.hadoop.hdfs.TestFiHFlush.hFlushFi01_a (from
TestFiHFlush)Stacktracejunit.framework.AssertionFailedError: <br/>	at
org.apache.hadoop.hdfs.TestFiHFlush.runDiskErrorTest(TestFiHFlush.java:56)<br/>	at
org.apache.hadoop.hdfs.TestFiHFlush.hFlushFi01_a(TestFiHFlush.java:72) 


New Comment: 
Hudson still cannot add comments  to Jira. So I am manually add them <a
href="http://hudson.zones.apache.org/hudson/view/Hdfs/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/312"
class="external-link"
rel="nofollow">http://hudson.zones.apache.org/hudson/view/Hdfs/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/312</a><div
class="code panel" style="border-width: 1px;"><div class="codeContent panelContent"><pre
class="code-java">[exec] -1 overall.  Here are the results of testing the latest
attachment      [exec]   http:<span
class="code-comment">//issues.apache.org/jira/secure/attachment/12441369/hdfs-1031_aoriani_2.patch</span>
    [exec]   against trunk revision 933428.     [exec]      [exec]     +1 @author.  The
patch does not contain any @author tags.     [exec]      [exec]     +1 tests included. 
The patch appears to include 2 <span class="code-keyword">new</span> or modified tests.   
 [exec]      [exec]     +1 javadoc.  The javadoc tool did not generate any warning
messages.     [exec]      [exec]     +1 javac.  The applied patch does not increase the
total number of javac compiler warnings.     [exec]      [exec]     +1 findbugs.  The
patch does not introduce any <span class="code-keyword">new</span> Findbugs warnings.    
[exec]      [exec]     +1 release audit.  The applied patch does not increase the total
number of release audit warnings.     [exec]      [exec]     +1 core tests.  The patch
passed core unit tests.     [exec]      [exec]     -1 contrib tests.  The patch failed
contrib unit tests.     [exec]      [exec] Test results: http:<span
class="code-comment">//hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/312/testReport/</span>
    [exec] Findbugs warnings: http:<span
class="code-comment">//hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/312/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html</span>
    [exec] Checkstyle results: http:<span
class="code-comment">//hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/312/artifact/trunk/build/test/checkstyle-errors.html</span>
    [exec] Console output: http:<span
class="code-comment">//hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/312/console</span></pre></div></div>
 The only failed test is a hdfsproxy test, not related t this bug<div class="code panel"
style="border-width: 1px;"><div class="codeContent panelContent"><pre
class="code-java">[exec] -1 overall.  Here are the results of testing the latest
attachment      [exec]   http:<span
class="code-comment">//issues.apache.org/jira/secure/attachment/12441369/hdfs-1031_aoriani_2.patch</span>
    [exec]   against trunk revision 933428.     [exec]      [exec]     +1 @author.  The
patch does not contain any @author tags.     [exec]      [exec]     +1 tests included. 
The patch appears to include 2 <span class="code-keyword">new</span> or modified tests.   
 [exec]      [exec]     +1 javadoc.  The javadoc tool did not generate any warning
messages.     [exec]      [exec]     +1 javac.  The applied patch does not increase the
total number of javac compiler warnings.     [exec]      [exec]     +1 findbugs.  The
patch does not introduce any <span class="code-keyword">new</span> Findbugs warnings.    
[exec]      [exec]     +1 release audit.  The applied patch does not increase the total
number of release audit warnings.     [exec]      [exec]     +1 core tests.  The patch
passed core unit tests.     [exec]      [exec]     -1 contrib tests.  The patch failed
contrib unit tests.     [exec]      [exec] Test results: http:<span
class="code-comment">//hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/312/testReport/</span>
    [exec] Findbugs warnings: http:<span
class="code-comment">//hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/312/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html</span>
    [exec] Checkstyle results: http:<span
class="code-comment">//hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/312/artifact/trunk/build/test/checkstyle-errors.html</span>
    [exec] Console output: http:<span
class="code-comment">//hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/312/console</span></pre></div></div> 


New Comment: 
Oops! Log for failed test here :<div class="code panel" style="border-width: 1px;"><div
class="codeContent panelContent"><pre class="code-java">     [exec] compile:     [exec]   
  [echo] contrib: hdfsproxy     [exec]     [exec] compile-examples:     [exec]     [exec]
compile-test:     [exec]      [echo] contrib: hdfsproxy     [exec]     [javac] Compiling 9
source files to
/grid/0/hudson/hudson-slave/workspace/Hdfs-Patch-h5.grid.sp2.yahoo.net/trunk/build/contrib/hdfsproxy/test
    [exec]     [exec] test-junit:     [exec]     [junit] WARNING: multiple versions of ant
detected in path <span class="code-keyword">for</span> junit     [exec]     [junit]       
  jar:file:/homes/hudson/tools/ant/latest/lib/ant.jar!/org/apache/tools/ant/Project.class 
   [exec]     [junit]      and
jar:file:/homes/hudson/.ivy2/cache/ant/ant/jars/ant-1.6.5.jar!/org/apache/tools/ant/Project.class
    [exec]     [junit] Running org.apache.hadoop.hdfsproxy.TestHdfsProxy     [exec]    
[junit] Tests run: 1, Failures: 0, Errors: 1, Time elapsed: 32.246 sec     [exec]    
[junit] Test org.apache.hadoop.hdfsproxy.TestHdfsProxy FAILED     [exec]     [exec] BUILD
FAILED     [exec]
/grid/0/hudson/hudson-slave/workspace/Hdfs-Patch-h5.grid.sp2.yahoo.net/trunk/build.xml:582:
The following error occurred <span class="code-keyword">while</span> executing <span
class="code-keyword">this</span> line:     [exec]
/grid/0/hudson/hudson-slave/workspace/Hdfs-Patch-h5.grid.sp2.yahoo.net/trunk/src/contrib/build.xml:48:
The following error occurred <span class="code-keyword">while</span> executing <span
class="code-keyword">this</span> line:     [exec]
/grid/0/hudson/hudson-slave/workspace/Hdfs-Patch-h5.grid.sp2.yahoo.net/trunk/src/contrib/hdfsproxy/build.xml:260:
Tests failed!     [exec]     [exec] Total time: 47 seconds</pre></div></div> 


New Comment: 
Thanks for contributing!  Minor comments follow:<ul>	<li>corruptFileCount == 0 could
indicate there are no corrupt files, ie not just that it wasn't unable to locate any. 
Would change the message to something like "There are no corrupt files found. You can run
fsck to verify that filesystem is healthy."</li>	<li>Please convert the uinit test to
junit 4 style (eg don't extend TestCase, add setup, teardown, use @Test etc. see 
FileContextSymlinkBaseTest.java for an example).</li></ul> 


New Comment: 
Upmerged to trunk<br/>Applied suggestions from comment<br/>Test was modified to use JUnit4
styte use the @Test annotation and static import of assertion methods. I did not write any
setup or tearDown method because there is only method, the subtests are not independent.
and I don't foresee the reutilization of setup routine.Hudson is currently not publishing
the build results. Once the build ends I will publish the results here. 


New Comment: 
Adding hudson results, including  the log for failed test. Same result from previous
build. Hdfsproxy test still failing but it is not related to this code<div class="code
panel" style="border-width: 1px;"><div class="codeContent panelContent"><pre
class="code-java">     [exec] compile-test:     [exec]      [echo] contrib: hdfsproxy    
[exec]     [javac] Compiling 9 source files to
/grid/0/hudson/hudson-slave/workspace/Hdfs-Patch-h5.grid.sp2.yahoo.net/trunk/build/contrib/hdfsproxy/test
    [exec]      [exec] test-junit:     [exec]     [junit] WARNING: multiple versions of
ant detected in path <span class="code-keyword">for</span> junit      [exec]     [junit]  
      
jar:file:/homes/hudson/tools/ant/latest/lib/ant.jar!/org/apache/tools/ant/Project.class   
 [exec]     [junit]      and
jar:file:/homes/hudson/.ivy2/cache/ant/ant/jars/ant-1.6.5.jar!/org/apache/tools/ant/Project.class
    [exec]     [junit] Running org.apache.hadoop.hdfsproxy.TestHdfsProxy     [exec]    
[junit] Tests run: 1, Failures: 0, Errors: 1, Time elapsed: 3.17 sec     [exec]    
[junit] Test org.apache.hadoop.hdfsproxy.TestHdfsProxy FAILED     [exec]      [exec] BUILD
FAILED     [exec]
/grid/0/hudson/hudson-slave/workspace/Hdfs-Patch-h5.grid.sp2.yahoo.net/trunk/build.xml:582:
The following error occurred <span class="code-keyword">while</span> executing <span
class="code-keyword">this</span> line:     [exec]
/grid/0/hudson/hudson-slave/workspace/Hdfs-Patch-h5.grid.sp2.yahoo.net/trunk/src/contrib/build.xml:48:
The following error occurred <span class="code-keyword">while</span> executing <span
class="code-keyword">this</span> line:     [exec]
/grid/0/hudson/hudson-slave/workspace/Hdfs-Patch-h5.grid.sp2.yahoo.net/trunk/src/contrib/hdfsproxy/build.xml:260:
Tests failed!     [exec]      [exec] Total time: 12 seconds     [exec]      [exec]     
[exec]      [exec]      [exec] -1 overall.  Here are the results of testing the latest
attachment      [exec]   http:<span
class="code-comment">//issues.apache.org/jira/secure/attachment/12441789/hdfs-1031_aoriani_3.patch</span>
    [exec]   against trunk revision 934196.     [exec]      [exec]     +1 @author.  The
patch does not contain any @author tags.     [exec]      [exec]     +1 tests included. 
The patch appears to include 2 <span class="code-keyword">new</span> or modified tests.   
 [exec]      [exec]     +1 javadoc.  The javadoc tool did not generate any warning
messages.     [exec]      [exec]     +1 javac.  The applied patch does not increase the
total number of javac compiler warnings.     [exec]      [exec]     +1 findbugs.  The
patch does not introduce any <span class="code-keyword">new</span> Findbugs warnings.    
[exec]      [exec]     +1 release audit.  The applied patch does not increase the total
number of release audit warnings.     [exec]      [exec]     +1 core tests.  The patch
passed core unit tests.     [exec]      [exec]     -1 contrib tests.  The patch failed
contrib unit tests.     [exec]      [exec] Test results: http:<span
class="code-comment">//hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/314/testReport/</span>
    [exec] Findbugs warnings: http:<span
class="code-comment">//hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/314/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html</span>
    [exec] Checkstyle results: http:<span
class="code-comment">//hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/314/artifact/trunk/build/test/checkstyle-errors.html</span>
    [exec] Console output: http:<span
class="code-comment">//hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/314/console</span>
    [exec]      [exec] This message is automatically generated.</pre></div></div> 


New Comment: 
HDFS has metasave command that provides this information. Do we still need this on web UI? 


New Comment: 
if u run metasave on a namenode that ahs anywhere close to 50 million files, the NN hangs
for about 8 minutes Not really useful, isn't it? 


New Comment: 
I'm sorry I'm a little late on this discussion, but I don't agree with Eli's comment on
the message when corruptFileCount == 0. The API nn.getCorruptFiles() is based on the list
of blocks that need replication and might not be up-to-date (<a
href="https://issues.apache.org/jira/browse/HDFS-729" title="fsck option to list only
corrupted files" class="issue-link" data-issue-key="HDFS-729"><del>HDFS-729</del></a>).
For instance, I think it returns 0 if the namenode is on safe mode. We had a similar
discussion on <a href="https://issues.apache.org/jira/browse/HDFS-1032" title="Extend
DFSck with an option to list corrupt files using API from HDFS-729" class="issue-link"
data-issue-key="HDFS-1032"><del>HDFS-1032</del></a> and we decided to go for the message
André had before ("unable to locate any"-style). Maybe we should use something in between
"100% guaranteed it's safe" and "Please don't trust me".What about "No missing blocks
found at the moment. Please run fsck for a thorough health analysis." ? 


New Comment: 
An "Unable to locate any" style message sounds good to me, I just thought "No corrupt
files yet" looked odd. 


New Comment: 
So should we stick to Rodrigo's message for the zero case? The output is not is not
sorted. Considering there is a ceiling of 500 files, should it be sorted? 


New Comment: 
Printing the output in lexicographical order seems to be best thing. 


New Comment: 
+1 to sorting the output.Also, in dfshealth.jsp, can we change "See corrupt files" to
"List corrupt files" 


New Comment: 
+1 to "List corrupt files" 


New Comment: 
One doubt regarding sorting the output. On my work, l10n is a daily concern, so I pay
attention to that when coding.<br/>We're going to compare Paths. Path.compareTo method
delegates its implementation to java.net.URI.compareTo, which uses String.compareTo for
path elements. That method of String class does not uses collation.So for the program:<div
class="code panel" style="border-width: 1px;"><div class="codeContent panelContent"><pre
class="code-java"><span class="code-keyword">import</span> java.net.URI;<span
class="code-keyword">import</span> java.net.URISyntaxException;<span
class="code-keyword">import</span> java.util.Arrays;<span
class="code-keyword">public</span> <span class="code-keyword">class </span>PathComparisons
{	<span class="code-keyword">public</span> <span class="code-keyword">static</span> void
main(<span class="code-object">String</span>[] args) {		<span
class="code-keyword">try</span> {			URI paths[] = { <span class="code-keyword">new</span>
URI(<span class="code-quote">"file:<span class="code-comment">///b/a"</span>), <span
class="code-keyword">new</span> URI(<span
class="code-quote">"file:///a/c"</span>),</span>					<span class="code-keyword">new</span>
URI(<span class="code-quote">"file:<span class="code-comment">///a/b"</span>), <span
class="code-keyword">new</span> URI(<span
class="code-quote">"file:///b/z"</span>),</span>					<span class="code-keyword">new</span>
URI(<span class="code-quote">"file:<span class="code-comment">///a/á"</span>), <span
class="code-keyword">new</span> URI(<span
class="code-quote">"file:///b/ç"</span>),</span>					<span class="code-keyword">new</span>
URI(<span class="code-quote">"file:<span
class="code-comment">///a/b/c/d/e"</span>)};</span>			Arrays.sort(paths);			<span
class="code-keyword">for</span> (URI path : paths) {<span
class="code-object">System</span>.out.println(path.toString());}		} <span
class="code-keyword">catch</span> (URISyntaxException e) {		}	}}</pre></div></div>The
output is <div class="preformatted panel" style="border-width: 1px;"><div
class="preformattedContent
panelContent"><pre>file:///a/bfile:///a/b/c/d/efile:///a/cfile:///a/áfile:///b/afile:///b/zfile:///b/ç</pre></div></div>I
mean , the character order is {a,b,z,á,ç} instead of  an expected {a,á,b,c,ç,z}Should I
handle this or treat it as a minor side-effect ? 


New Comment: 
Side effect in my opinion! 


New Comment: 
Suggestions applied<br/>File list sorted<br/>Some changes made due semantic issues (
listed files are not potentially corrupt, but in fact corrupt.  The list is potentially
incomplete) 


New Comment: 
In case hudson is still not adding test result to Jira, the build is <a
href="http://hudson.zones.apache.org/hudson/view/Hdfs/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/321"
class="external-link"
rel="nofollow">http://hudson.zones.apache.org/hudson/view/Hdfs/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/321</a> 


New Comment: 
-1 overall.  Here are the results of testing the latest attachment <br/>  <a
href="http://issues.apache.org/jira/secure/attachment/12442391/hdfs-1031_aoriani_4.patch"
class="external-link"
rel="nofollow">http://issues.apache.org/jira/secure/attachment/12442391/hdfs-1031_aoriani_4.patch</a><br/>
 against trunk revision 936132.    +1 @author.  The patch does not contain any @author
tags.    +1 tests included.  The patch appears to include 2 new or modified tests.    +1
javadoc.  The javadoc tool did not generate any warning messages.    +1 javac.  The
applied patch does not increase the total number of javac compiler warnings.    +1
findbugs.  The patch does not introduce any new Findbugs warnings.    +1 release audit. 
The applied patch does not increase the total number of release audit warnings.    -1 core
tests.  The patch failed core unit tests.    -1 contrib tests.  The patch failed contrib
unit tests.Test results: <a
href="http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/321/testReport/"
class="external-link"
rel="nofollow">http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/321/testReport/</a><br/>Findbugs
warnings: <a
href="http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/321/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html"
class="external-link"
rel="nofollow">http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/321/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html</a><br/>Checkstyle
results: <a
href="http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/321/artifact/trunk/build/test/checkstyle-errors.html"
class="external-link"
rel="nofollow">http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/321/artifact/trunk/build/test/checkstyle-errors.html</a><br/>Console
output: <a
href="http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/321/console"
class="external-link"
rel="nofollow">http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/321/console</a>This
message is automatically generated. 


New Comment: 
Failed core testjava.lang.IllegalMonitorStateException<br/>	at
java.lang.Object.notifyAll(Native Method)<br/>	at
org.apache.hadoop.ipc.Server.stop(Server.java:1469)<br/>	at
org.apache.hadoop.hdfs.server.namenode.NameNode.stop(NameNode.java:473)<br/>	at
org.apache.hadoop.hdfs.MiniDFSCluster.shutdown(MiniDFSCluster.java:619)<br/>	at
org.apache.hadoop.hdfs.server.namenode.TestNameEditsConfigs.testNameEditsConfigs(TestNameEditsConfigs.java:228)Failed
contributed test<span class="error">&#91;exec&#93;</span> test-junit:<br/>     <span
class="error">&#91;exec&#93;</span>     <span class="error">&#91;junit&#93;</span>
WARNING: multiple versions of ant detected in path for junit <br/>     <span
class="error">&#91;exec&#93;</span>     <span class="error">&#91;junit&#93;</span>        
 jar:<a
href="file:/homes/hudson/tools/ant/latest/lib/ant.jar!/org/apache/tools/ant/Project.class"
class="external-link"
rel="nofollow">file:/homes/hudson/tools/ant/latest/lib/ant.jar!/org/apache/tools/ant/Project.class</a><br/>
    <span class="error">&#91;exec&#93;</span>     <span
class="error">&#91;junit&#93;</span>      and jar:<a
href="file:/homes/hudson/.ivy2/cache/ant/ant/jars/ant-1.6.5.jar!/org/apache/tools/ant/Project.class"
class="external-link"
rel="nofollow">file:/homes/hudson/.ivy2/cache/ant/ant/jars/ant-1.6.5.jar!/org/apache/tools/ant/Project.class</a><br/>
    <span class="error">&#91;exec&#93;</span>     <span
class="error">&#91;junit&#93;</span> Running
org.apache.hadoop.hdfsproxy.TestHdfsProxy<br/>     <span
class="error">&#91;exec&#93;</span>     <span class="error">&#91;junit&#93;</span> Tests
run: 1, Failures: 0, Errors: 1, Time elapsed: 37.468 sec<br/>     <span
class="error">&#91;exec&#93;</span>     <span class="error">&#91;junit&#93;</span> Test
org.apache.hadoop.hdfsproxy.TestHdfsProxy FAILED<br/>     <span
class="error">&#91;exec&#93;</span> <br/>     <span class="error">&#91;exec&#93;</span>
BUILD FAILED<br/>     <span class="error">&#91;exec&#93;</span>
/grid/0/hudson/hudson-slave/workspace/Hdfs-Patch-h5.grid.sp2.yahoo.net/trunk/build.xml:582:
The following error occurred while executing this line:<br/>     <span
class="error">&#91;exec&#93;</span>
/grid/0/hudson/hudson-slave/workspace/Hdfs-Patch-h5.grid.sp2.yahoo.net/trunk/src/contrib/build.xml:48:
The following error occurred while executing this line:<br/>     <span
class="error">&#91;exec&#93;</span>
/grid/0/hudson/hudson-slave/workspace/Hdfs-Patch-h5.grid.sp2.yahoo.net/trunk/src/contrib/hdfsproxy/build.xml:260:
Tests failed!Both unrelated to this patch 


New Comment: 
The patch looks good. Just one minor nitpick: Can you add a final "." to the sentence
"Please run fsck for a thorough health analysis"?Thanks! 


New Comment: 
Minor fix made 


New Comment: 
-1 overall.  Here are the results of testing the latest attachment <br/>  <a
href="http://issues.apache.org/jira/secure/attachment/12442542/hdfs-1031_aoriani_5.patch"
class="external-link"
rel="nofollow">http://issues.apache.org/jira/secure/attachment/12442542/hdfs-1031_aoriani_5.patch</a><br/>
 against trunk revision 936473.    +1 @author.  The patch does not contain any @author
tags.    +1 tests included.  The patch appears to include 2 new or modified tests.    +1
javadoc.  The javadoc tool did not generate any warning messages.    +1 javac.  The
applied patch does not increase the total number of javac compiler warnings.    +1
findbugs.  The patch does not introduce any new Findbugs warnings.    +1 release audit. 
The applied patch does not increase the total number of release audit warnings.    -1 core
tests.  The patch failed core unit tests.    -1 contrib tests.  The patch failed contrib
unit tests.Test results: <a
href="http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/322/testReport/"
class="external-link"
rel="nofollow">http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/322/testReport/</a><br/>Findbugs
warnings: <a
href="http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/322/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html"
class="external-link"
rel="nofollow">http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/322/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html</a><br/>Checkstyle
results: <a
href="http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/322/artifact/trunk/build/test/checkstyle-errors.html"
class="external-link"
rel="nofollow">http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/322/artifact/trunk/build/test/checkstyle-errors.html</a><br/>Console
output: <a
href="http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/322/console"
class="external-link"
rel="nofollow">http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/322/console</a>This
message is automatically generated. 


New Comment: 
+1. Patch looks good. Thanks André! 


New Comment: 
Thanks guys. I am going to commit this soon, unless anybody else has any other review
comments. 


New Comment: 
No further comments. 


