Pattern changes caused by commit: ba8f60154a41b0bd2d72a6572e939c09b7ea9657

From: Decorator-1
To:   Decorator-0

From: Flyweight-4
To:   Flyweight-5

From: Strategy-1
To:   Strategy-0


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-4800.txt 

commit ba8f60154a41b0bd2d72a6572e939c09b7ea9657
Author: Jonathan Ellis <jbellis@apache.org>

    avoid trying to watch cassandra-topology.properties when loaded from jar
    patch by Mck SembWever; reviewed by jbellis for CASSANDRA-3138



==================================
 Issue CASSANDRA-3138 Description 
=======================================

Project: Cassandra
-----------------

-----------------
Title: [CASSANDRA-3138] PropertyFileSnitch's ResourceWatcher fails because it uses FBUtilities.resourceToFile(..) while PropertyFileSnitch uses classloader.getResourceAsStream(..)
-----------------

-----------------
Summary: PropertyFileSnitch's ResourceWatcher fails because it uses FBUtilities.resourceToFile(..) while PropertyFileSnitch uses classloader.getResourceAsStream(..)
-----------------

-----------------
Issue type: Bug
-----------------

-----------------
Current status: Resolved
-----------------

-----------------
Created at: Mon, 5 Sep 2011 16:41:45 +0000
-----------------

-----------------
Resolved at: Mon, 5 Sep 2011 19:59:56 +0000
-----------------

-----------------
Assigned to: Michael Semb Wever
-----------------

-----------------
Description: 

Resource files are not necessarily plain files. They could be inside a jar file. See <a
href="https://issues.apache.org/jira/browse/CASSANDRA-2036"
title="cassandra-topology.properties cannot reside inside jar file" class="issue-link"
data-issue-key="CASSANDRA-2036"><del>CASSANDRA-2036</del></a>

This will cause 
<div
class="preformatted panel" style="border-width: 1px;"><div class="preformattedContent
panelContent"><pre>RROR 24:15,806 ResourceWatcher$WatchedResource: Timed run of class
org.apache.cassandra.locator.PropertyFileSnitch$1
failed.org.apache.cassandra.config.ConfigurationException: unable to locate
cassandra-topology.properties	at
org.apache.cassandra.utils.FBUtilities.resourceToFile(FBUtilities.java:467)	at
org.apache.cassandra.utils.ResourceWatcher$WatchedResource.run(ResourceWatcher.java:57)	at
java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)	at
java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317)	at
java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150)	at
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98)	at
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:180)	at
java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:204)	at
java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)	at
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)	at
java.lang.Thread.run(Thread.java:662)</pre></div></div> 

-----------------

-----------------
Comments: 

New Comment: 
Simple solution that prevents the ResourceWatcher for PropertyFileSnitch from being
submitted if the property file is not a plain file on disk. 


New Comment: 
committed (w/ logged message at debug), thanks! 


New Comment: 
Integrated in Cassandra-0.8 #314 (See <a
href="https://builds.apache.org/job/Cassandra-0.8/314/" class="external-link"
rel="nofollow">https://builds.apache.org/job/Cassandra-0.8/314/</a>)<br/>    avoid trying
to watch cassandra-topology.properties when loaded from jar<br/>patch by Mck SembWever;
reviewed by jbellis for <a href="https://issues.apache.org/jira/browse/CASSANDRA-3138"
title="PropertyFileSnitch&#39;s ResourceWatcher fails because it uses
FBUtilities.resourceToFile(..) while PropertyFileSnitch uses
classloader.getResourceAsStream(..)" class="issue-link"
data-issue-key="CASSANDRA-3138"><del>CASSANDRA-3138</del></a>jbellis : <a
href="http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;view=rev&amp;rev=1165405"
class="external-link"
rel="nofollow">http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;view=rev&amp;rev=1165405</a><br/>Files
:
<ul>	<li>/cassandra/branches/cassandra-0.8/CHANGES.txt</li>	<li>/cassandra/branches/cassandra-0.8/src/java/org/apache/cassandra/locator/PropertyFileSnitch.java</li></ul> 


