Pattern changes caused by commit: db2d62c22ab514efcb3c137f3b09f2270df84aa6

From: Decorator-0
To:   Decorator-1

From: Mediator-2
To:   Mediator-3


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-4672.txt 

commit db2d62c22ab514efcb3c137f3b09f2270df84aa6
Author: Pavel Yaskevich <xedin@apache.org>

    Fix sstable file scan when one ColumnFamily starts with the name of another
    patch by Pavel Yaskevich; reviewed by Jonathan Ellis for CASSANDRA-3040



==================================
 Issue CASSANDRA-3040 Description 
=======================================

Project: Cassandra
-----------------

-----------------
Title: [CASSANDRA-3040] Refactor and optimize ColumnFamilyStore.files(...) and Descriptor.fromFilename and few other places responsible for work with SSTable files.
-----------------

-----------------
Summary: Refactor and optimize ColumnFamilyStore.files(...) and Descriptor.fromFilename and few other places responsible for work with SSTable files.
-----------------

-----------------
Issue type: Improvement
-----------------

-----------------
Current status: Resolved
-----------------

-----------------
Created at: Tue, 16 Aug 2011 16:46:56 +0000
-----------------

-----------------
Resolved at: Fri, 19 Aug 2011 20:47:50 +0000
-----------------

-----------------
Assigned to: Pavel Yaskevich
-----------------

-----------------
Description: 

ColumnFamilyStore.files(...) methods are not optimal in a sense of work they are doing -
scanning whole table directory for files and directories, but it's mission is to locate CF
specific files only.<br/>Descriptor.fromFilename could be refactored to use getParentFile
and getName methods instead of manual parsing of the path. Small refactorings in this
sense are planed for Component and SSTable classes.
 

-----------------

-----------------
Comments: 

New Comment: 
Happy to see what you come up with, but I warn that historically this has been a fragile
area.  Let's keep to 1.0-only. 


New Comment: 
Sure 


New Comment: 
+1 


New Comment: 
committed, thanks! 


New Comment: 
Integrated in Cassandra #1028 (See <a href="https://builds.apache.org/job/Cassandra/1028/"
class="external-link"
rel="nofollow">https://builds.apache.org/job/Cassandra/1028/</a>)<br/>    Refactor and
optimize ColumnFamilyStore.files(...) and Descriptor.fromFilename(String) and few other
places responsible for work with SSTable files<br/>patch by Pavel Yaskevich; reviewed by
Jonathan Ellis for <a href="https://issues.apache.org/jira/browse/CASSANDRA-3040"
title="Refactor and optimize ColumnFamilyStore.files(...) and Descriptor.fromFilename and
few other places responsible for work with SSTable files." class="issue-link"
data-issue-key="CASSANDRA-3040"><del>CASSANDRA-3040</del></a>xedin : <a
href="http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;view=rev&amp;rev=1158452"
class="external-link"
rel="nofollow">http://svn.apache.org/viewcvs.cgi/?root=Apache-SVN&amp;view=rev&amp;rev=1158452</a><br/>Files
:
<ul>	<li>/cassandra/trunk/src/java/org/apache/cassandra/io/sstable/SSTable.java</li>	<li>/cassandra/trunk/src/java/org/apache/cassandra/io/sstable/Descriptor.java</li>	<li>/cassandra/trunk/CHANGES.txt</li>	<li>/cassandra/trunk/src/java/org/apache/cassandra/db/ColumnFamilyStore.java</li></ul> 


New Comment: 
startsWith() is not a strong enough restriction: you'll still need an exact match for the
CF name at some  point (or to append the '-' separate character to your startsWith call.) 


New Comment: 
You are absolutely right, totally overlooked that! v2 introduces Component.separator
variable and refactoring of the Descriptor/Component to use that +
SSTable.componentsFor(...) and CFS.files(File, String) methods where changed  to match
SSTable prefix "cf.name + separator" instead of just cf.name. 


New Comment: 
+1 v2 


New Comment: 
Committed v2. 


