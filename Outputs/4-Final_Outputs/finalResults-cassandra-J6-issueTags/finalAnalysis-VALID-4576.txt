Pattern changes caused by commit: 31405c745373d1d2403ebe873ce6ecadb337e2c3

From: Decorator-1
To:   Decorator-0

From: Mediator-3
To:   Mediator-2


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-4576.txt 

commit 31405c745373d1d2403ebe873ce6ecadb337e2c3
Author: Jonathan Ellis <jbellis@apache.org>

    include files-to-be-streamed in StreamInSession.getSources
    patch by Yuki Morishita; reviewed by jbellis for CASSANDRA-2972



==================================
 Issue CASSANDRA-2972 Description 
=======================================

Project: Cassandra
-----------------

-----------------
Title: [CASSANDRA-2972] nodetool netstats progress does not update on receiving side
-----------------

-----------------
Summary: nodetool netstats progress does not update on receiving side
-----------------

-----------------
Issue type: Bug
-----------------

-----------------
Current status: Resolved
-----------------

-----------------
Created at: Sat, 30 Jul 2011 03:42:37 +0000
-----------------

-----------------
Resolved at: Wed, 3 Aug 2011 21:14:12 +0000
-----------------

-----------------
Assigned to: Yuki Morishita
-----------------

-----------------
Description: 

when you add/remove node to cluster, nodetool netstats show correct results only on
sending side - on receiving side you can see only 0% progress
 

-----------------

-----------------
Comments: 

New Comment: 
What do you think, Yuki? 


New Comment: 
Patch attached for 0.8 branch.<br/>StreamInSession holds references to all pending
files(files attribute) and current processing file(current attribute). The former include
the latter but those are different objects after deserialized, and only the latter gets
update on progress.<br/>When returning incoming streaming status via JMX, only the former
pending files described above are returned due to the nature of HashSet#add. 


New Comment: 
Slightly modified version. 


New Comment: 
I think we also need to update remoteFile.progress in IncomingStreamReader, at least in
the 0.8 branch 


New Comment: 
IncomingStreamReader#readnwrite (or SSLIncomingStreamReader#readwrite) in the 0.8 branch
does update remoteFile.progress, so the issue is just a matter of dispaying through JMX. 


New Comment: 
ah, you're right.  i was thrown off by the whacky indentation there for ISR. 


New Comment: 
committed v2 


