Pattern changes caused by commit: 6c70b83d055d9212c9ec8ad9437ed9d8a63a7882

From: Abstract Factory-2
To:   Abstract Factory-3

From: Factory Method-2
To:   Factory Method-3

From: Decorator-0
To:   Decorator-1

From: Facade-0
To:   Facade-1

From: Flyweight-5
To:   Flyweight-3

From: Strategy-0
To:   Strategy-1


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-5981.txt 

commit 6c70b83d055d9212c9ec8ad9437ed9d8a63a7882
Author: Pavel Yaskevich <xedin@apache.org>

    turn compression on by default
    patch by Pavel Yaskevich; reviewed by Sylvain Lebresne for CASSANDRA-3871



==================================
 Issue CASSANDRA-3871 Description 
=======================================

Project: Cassandra
-----------------

-----------------
Title: [CASSANDRA-3871] Turn compression on by default
-----------------

-----------------
Summary: Turn compression on by default
-----------------

-----------------
Issue type: Improvement
-----------------

-----------------
Current status: Resolved
-----------------

-----------------
Created at: Tue, 7 Feb 2012 14:44:59 +0000
-----------------

-----------------
Resolved at: Wed, 8 Feb 2012 18:21:05 +0000
-----------------

-----------------
Assigned to: Pavel Yaskevich
-----------------

-----------------
Description: 

Compression has been available but off by default since 1.0.0.  It's enabled in a lot of
production environments now, with no major problems found.  (Some problems with
customizing the block size were found and fixed in the 1.0 releases.)
 

-----------------

-----------------
Comments: 

New Comment: 
I believe this only turn compression on for column family initially created from a thrift
structure, as otherwise the default in CFMetaData.init() is still to not use compression.
I believe this has 2 consequences that I can see:<ol>	<li>it doesn't set compression by
default for CF created through CQL, since CreateColumnFamilyStatement uses CFMetaData
directly. we should at least fix that one.</li>	<li>it doesn't set compression by default
for the system CF, nor for secondary indexes. But for those one, that may be something we
want, I don't know. On the one side, if we think compression is a better default, why not
use it for everything, but on the other side, the user has not way to disable compression
for those, so we may want to wait a little bit more before enabling it there.</li></ol> 


New Comment: 
IMO a 2ary index CF should "inherit" the compression setting for its parent. 


New Comment: 
I forgot about CQL, v1 turns compression on by default if CF is created using CQL (cql,
cql3) and also adds a check to 'create columnfamily' and 'alter table' to disable
compression if 'compression_parameters:sstable_compression' was set to 'null'. 


New Comment: 
It would be cleaner to centralize the handling of null in
CompressionParameters.parseCompressorClass(). I'd also prefer using the empty string to
set no compression (partly because I think it's more natural, but also partly because I
don't want to have to care about some special casing of the grammar for <a
href="https://issues.apache.org/jira/browse/CASSANDRA-3783" title="Add &#39;null&#39;
support to CQL 3.0" class="issue-link"
data-issue-key="CASSANDRA-3783"><del>CASSANDRA-3783</del></a>).<blockquote>IMO a 2ary
index CF should "inherit" the compression setting for its parent.</blockquote>Agreed. But
as this is not fully related to that issue, I've created <a
href="https://issues.apache.org/jira/browse/CASSANDRA-3877" title="Make secondary indexes
inherit compression (and maybe other properties) from their base CFS" class="issue-link"
data-issue-key="CASSANDRA-3877"><del>CASSANDRA-3877</del></a> for that. 


New Comment: 
Overlooked that I can do that in CompressionParameters, fixed. Check for "null" as
'sstable_compression' is removed, users can use 'sstable_compression' set to '' to disable
compression. 


New Comment: 
+1 


