Pattern changes caused by commit: f659c6759dd2ec99472dfb194f82dedad3b5ae45

From: Abstract Factory-3
To:   Abstract Factory-2

From: Factory Method-3
To:   Factory Method-2


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-3382.txt 

commit f659c6759dd2ec99472dfb194f82dedad3b5ae45
Author: Jonathan Ellis <jbellis@apache.org>

    fix Hadoop ColumnFamilyOutputFormat droppingof mutations
    patch by Eldon Stegall and Jeremy Hanna; reviewed by jbellis for CASSANDRA-2255



==================================
 Issue CASSANDRA-2255 Description 
=======================================

Project: Cassandra
-----------------

-----------------
Title: [CASSANDRA-2255] ColumnFamilyOutputFormat drops mutations when batches fill up.
-----------------

-----------------
Summary: ColumnFamilyOutputFormat drops mutations when batches fill up.
-----------------

-----------------
Issue type: Bug
-----------------

-----------------
Current status: Resolved
-----------------

-----------------
Created at: Mon, 28 Feb 2011 21:06:16 +0000
-----------------

-----------------
Resolved at: Tue, 1 Mar 2011 02:52:25 +0000
-----------------

-----------------
Assigned to: Jeremy Hanna
-----------------

-----------------
Description: 

queue.poll() takes a mutation,<br/>but then the batch is already full,<br/>so the while
loop exits, ant the mutation we just got is dropped.
 

-----------------

-----------------
Comments: 

New Comment: 
This should help. 


New Comment: 
Should apply cleanly to 0.7.0 tag 


New Comment: 
Committed, thanks! 


New Comment: 
Integrated in Cassandra-0.7 #332 (See <a
href="https://hudson.apache.org/hudson/job/Cassandra-0.7/332/" class="external-link"
rel="nofollow">https://hudson.apache.org/hudson/job/Cassandra-0.7/332/</a>)<br/>    CFRW
no longer loses mutations.<br/>Patch by Eldon Stegall, reviewed by Stu Hood and
brandonwilliams for<br/><a href="https://issues.apache.org/jira/browse/CASSANDRA-2255"
title="ColumnFamilyOutputFormat drops mutations when batches fill up." class="issue-link"
data-issue-key="CASSANDRA-2255"><del>CASSANDRA-2255</del></a> 


New Comment: 
Doesn't this mean batch sizes can be arbitrarily large?  Not only will this cause latency
spikes on the server but you could OOM building the monster batch. 


New Comment: 
also: the mutation = null; line is dead code. 


New Comment: 
reverted 


New Comment: 
another go at the patch 


New Comment: 
lgtm, committed (we'll try to get it in to 0.7.3 re-spin) 


