Pattern changes caused by commit: 160cb28d97b3d14094e60f53cb760f3f145f72e3

From: Decorator-0
To:   Decorator-1

From: Flyweight-5
To:   Flyweight-4

From: Strategy-0
To:   Strategy-1


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-5098.txt 

commit 160cb28d97b3d14094e60f53cb760f3f145f72e3
Author: Jonathan Ellis <jbellis@apache.org>

    ignore any CF ids sent by client for adding CF/KS
    patch by jbellis and Nate McCall for CASSANDRA-3288



==================================
 Issue CASSANDRA-3288 Description 
=======================================

Project: Cassandra
-----------------

-----------------
Title: [CASSANDRA-3288] CfDef can default to an invalid id and fail during system_add_column_family
-----------------

-----------------
Summary: CfDef can default to an invalid id and fail during system_add_column_family
-----------------

-----------------
Issue type: Bug
-----------------

-----------------
Current status: Resolved
-----------------

-----------------
Created at: Fri, 30 Sep 2011 22:12:47 +0000
-----------------

-----------------
Resolved at: Sat, 1 Oct 2011 05:37:42 +0000
-----------------

-----------------
Assigned to: Jonathan Ellis
-----------------

-----------------
Description: 

The line from this commit:<br/><a
href="https://github.com/apache/cassandra/commit/38e3e85b121ba6308ba3ceb26312d12ed0d609ec#L1R683"
class="external-link"
rel="nofollow">https://github.com/apache/cassandra/commit/38e3e85b121ba6308ba3ceb26312d12ed0d609ec#L1R683</a>

Introduced
an issue in that some clients, particularly Hector, will send a CfDef with an ID having
been set to 0. Done via the CfDef#setId, the isSetId bit is flipped to true, causing error
if schemaId of 0 already exists, which given the use case, is likely. 

Since we know the
context of a system_create_column_family, this can be sidestepped by just stepping on
whatever ID is there (irrelevant on a create anyway) with the value returned from:
Schema.instance.nextCFId()
 

-----------------

-----------------
Comments: 

New Comment: 
patch to explicitly ignore client-set ids on create 


New Comment: 
first reported on <a
href="http://www.mail-archive.com/user@cassandra.apache.org/msg17649.html"
class="external-link"
rel="nofollow">http://www.mail-archive.com/user@cassandra.apache.org/msg17649.html</a> 


New Comment: 
v2 adds same ignore for system_add_keyspace 


