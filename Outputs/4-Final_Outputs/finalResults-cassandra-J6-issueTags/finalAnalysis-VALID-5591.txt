Pattern changes caused by commit: a95bd467aef3f44ec474734277b65b09a884362c

From: Facade-1
To:   Facade-0


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-5591.txt 

commit a95bd467aef3f44ec474734277b65b09a884362c
Author: Jonathan Ellis <jbellis@apache.org>

    revert interruptible cache saving
    patch by slebresne; reviewed by jbellis for CASSANDRA-3566



==================================
 Issue CASSANDRA-3566 Description 
=======================================

Project: Cassandra
-----------------

-----------------
Title: [CASSANDRA-3566] Cache saving broken on windows
-----------------

-----------------
Summary: Cache saving broken on windows
-----------------

-----------------
Issue type: Bug
-----------------

-----------------
Current status: Resolved
-----------------

-----------------
Created at: Fri, 2 Dec 2011 23:26:07 +0000
-----------------

-----------------
Resolved at: Tue, 6 Dec 2011 20:52:16 +0000
-----------------

-----------------
Assigned to: Sylvain Lebresne
-----------------

-----------------
Description: 

<a href="https://issues.apache.org/jira/browse/CASSANDRA-1740" title="Nodetool commands
to query and stop compaction, repair, cleanup and scrub" class="issue-link"
data-issue-key="CASSANDRA-1740"><del>CASSANDRA-1740</del></a> broke cache saving on
Windows.
 

-----------------

-----------------
Comments: 

New Comment: 
All the cache tests fail with an exception like this:<div class="preformatted panel"
style="border-width: 1px;"><div class="preformattedContent panelContent"><pre>    [junit]
Testcase: testKeyCacheLoad(org.apache.cassandra.db.KeyCacheTest):   Caused an ERROR   
[junit] java.lang.RuntimeException: java.io.IOException: Unable to rename
build\test\cassandra\saved_caches\KeyCacheSpace-Standard3-KeyCache7847563715233372577.tmp
to build\test\cassandra\saved_caches\KeyCacheSpace-Standard3-KeyCache    [junit]
java.util.concurrent.ExecutionException: java.lang.RuntimeException: java.io.IOException:
Unable to rename
build\test\cassandra\saved_caches\KeyCacheSpace-Standard3-KeyCache7847563715233372577.tmp
to build\test\cassandra\saved_caches\KeyCacheSpace-Standard3-KeyCache    [junit]     at
java.util.concurrent.FutureTask$Sync.innerGet(FutureTask.java:222)    [junit]     at
java.util.concurrent.FutureTask.get(FutureTask.java:83)    [junit]     at
org.apache.cassandra.db.KeyCacheTest.testKeyCacheLoad(KeyCacheTest.java:87)    [junit]
Caused by: java.lang.RuntimeException: java.io.IOException: Unable to rename
build\test\cassandra\saved_caches\KeyCacheSpace-Standard3-KeyCache7847563715233372577.tmp
to build\test\cassandra\saved_caches\KeyCacheSpace-Standard3-KeyCache    [junit]     at
org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:37)    [junit]     at
java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)    [junit]     at
java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)    [junit]     at
java.util.concurrent.FutureTask.run(FutureTask.java:138)    [junit]     at
java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)   
[junit]     at
java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)    [junit]
    at java.lang.Thread.run(Thread.java:662)    [junit] Caused by: java.io.IOException:
Unable to rename
build\test\cassandra\saved_caches\KeyCacheSpace-Standard3-KeyCache7847563715233372577.tmp
to build\test\cassandra\saved_caches\KeyCacheSpace-Standard3-KeyCache    [junit]     at
org.apache.cassandra.cache.AutoSavingCache$Writer.saveCache(AutoSavingCache.java:265)   
[junit]     at
org.apache.cassandra.db.compaction.CompactionManager$10.runMayThrow(CompactionManager.java:907)
   [junit]     at org.apache.cassandra.utils.WrappedRunnable.run(WrappedRunnable.java:30) 
  [junit]    [junit]    [junit] Test org.apache.cassandra.db.KeyCacheTest
FAILED</pre></div></div> 


New Comment: 
I'd be totally fine with just ripping the cancellation code out of cache saving.  Cache
saving will be very fast compared to most actual compactions. 


New Comment: 
I'm totally with that too. Patch attach to rip that part. 


