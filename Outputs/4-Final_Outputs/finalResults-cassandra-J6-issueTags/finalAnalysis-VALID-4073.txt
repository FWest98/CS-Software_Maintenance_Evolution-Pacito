Pattern changes caused by commit: 21b5cdb899a7a8ea24b90810e2d32716acc3d7c5

From: Abstract Factory-3
To:   Abstract Factory-2

From: Factory Method-3
To:   Factory Method-2

From: Mediator-2
To:   Mediator-1


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-4073.txt 

commit 21b5cdb899a7a8ea24b90810e2d32716acc3d7c5
Author: Jonathan Ellis <jbellis@apache.org>

    adjust hinted handoff page size to avoid OOM with large columns
    patch by jbellis; reviewed by brandonwilliams for CASSANDRA-2652



==================================
 Issue CASSANDRA-2652 Description 
=======================================

Project: Cassandra
-----------------

-----------------
Title: [CASSANDRA-2652] Hinted handoff needs to adjust page size for lage columns to avoid OOM
-----------------

-----------------
Summary: Hinted handoff needs to adjust page size for lage columns to avoid OOM
-----------------

-----------------
Issue type: Bug
-----------------

-----------------
Current status: Resolved
-----------------

-----------------
Created at: Sat, 14 May 2011 14:52:04 +0000
-----------------

-----------------
Resolved at: Mon, 16 May 2011 21:16:06 +0000
-----------------

-----------------
Assigned to: Jonathan Ellis
-----------------

-----------------
Description: 

Example OOM:
<div class="preformatted panel" style="border-width: 1px;"><div
class="preformattedContent panelContent"><pre>java.lang.OutOfMemoryError: Java heap
space	at
org.apache.cassandra.io.util.BufferedRandomAccessFile.readBytes(BufferedRandomAccessFile.java:269)	at
org.apache.cassandra.utils.ByteBufferUtil.read(ByteBufferUtil.java:356)	at
org.apache.cassandra.utils.ByteBufferUtil.readWithLength(ByteBufferUtil.java:318)	at
org.apache.cassandra.db.ColumnSerializer.deserialize(ColumnSerializer.java:99)	at
org.apache.cassandra.io.util.ColumnIterator.deserializeNext(ColumnSortedMap.java:248)	at
org.apache.cassandra.io.util.ColumnIterator.next(ColumnSortedMap.java:268)	at
org.apache.cassandra.io.util.ColumnIterator.next(ColumnSortedMap.java:227)	at
java.util.concurrent.ConcurrentSkipListMap.buildFromSorted(ConcurrentSkipListMap.java:1493)	at
java.util.concurrent.ConcurrentSkipListMap.&lt;init&gt;(ConcurrentSkipListMap.java:1443)	at
org.apache.cassandra.db.SuperColumnSerializer.deserialize(SuperColumn.java:379)	at
org.apache.cassandra.db.SuperColumnSerializer.deserialize(SuperColumn.java:362)	at
org.apache.cassandra.db.SuperColumnSerializer.deserialize(SuperColumn.java:322)	at
org.apache.cassandra.db.columniterator.IndexedSliceReader$IndexedBlockFetcher.getNextBlock(IndexedSliceReader.java:179)	at
org.apache.cassandra.db.columniterator.IndexedSliceReader.computeNext(IndexedSliceReader.java:121)	at
org.apache.cassandra.db.columniterator.IndexedSliceReader.computeNext(IndexedSliceReader.java:49)	at
com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:136)	at
com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:131)	at
org.apache.cassandra.db.columniterator.SSTableSliceIterator.hasNext(SSTableSliceIterator.java:108)	at
org.apache.commons.collections.iterators.CollatingIterator.set(CollatingIterator.java:283)	at
org.apache.commons.collections.iterators.CollatingIterator.least(CollatingIterator.java:326)	at
org.apache.commons.collections.iterators.CollatingIterator.next(CollatingIterator.java:230)	at
org.apache.cassandra.utils.ReducingIterator.computeNext(ReducingIterator.java:69)	at
com.google.common.collect.AbstractIterator.tryToComputeNext(AbstractIterator.java:136)	at
com.google.common.collect.AbstractIterator.hasNext(AbstractIterator.java:131)	at
org.apache.cassandra.db.filter.SliceQueryFilter.collectReducedColumns(SliceQueryFilter.java:116)	at
org.apache.cassandra.db.filter.QueryFilter.collectCollatedColumns(QueryFilter.java:130)	at
org.apache.cassandra.db.ColumnFamilyStore.getTopLevelColumns(ColumnFamilyStore.java:1390)	at
org.apache.cassandra.db.ColumnFamilyStore.getColumnFamily(ColumnFamilyStore.java:1267)	at
org.apache.cassandra.db.ColumnFamilyStore.getColumnFamily(ColumnFamilyStore.java:1195)	at
org.apache.cassandra.db.HintedHandOffManager.sendMessage(HintedHandOffManager.java:138)	at
org.apache.cassandra.db.HintedHandOffManager.deliverHintsToEndpoint(HintedHandOffManager.java:331)	at
org.apache.cassandra.db.HintedHandOffManager.access$100(HintedHandOffManager.java:88)</pre></div></div> 

-----------------

-----------------
Comments: 

New Comment: 
(also renames sendMessage to sendRow.) 


New Comment: 
+1 


New Comment: 
committed 


