Pattern changes caused by commit: 9210d5776c26ca7f64ff896100890eb640ed2fe1

From: Abstract Factory-1
To:   Abstract Factory-2

From: Factory Method-1
To:   Factory Method-2


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-8206.txt 

commit 9210d5776c26ca7f64ff896100890eb640ed2fe1
Author: Aleksey Yeschenko <aleksey@apache.org>

    cqlsh: make it possible to describe thrift CFs;
    patch by Aleksey Yeschenko, reviewed by Jonathan Ellis for CASSANDRA-4827



==================================
 Issue CASSANDRA-4827 Description 
=======================================

Project: Cassandra
-----------------

-----------------
Title: [CASSANDRA-4827] cqlsh --cql3 unable to describe CF created with cli
-----------------

-----------------
Summary: cqlsh --cql3 unable to describe CF created with cli
-----------------

-----------------
Issue type: Bug
-----------------

-----------------
Current status: Resolved
-----------------

-----------------
Created at: Wed, 17 Oct 2012 21:55:57 +0000
-----------------

-----------------
Resolved at: Mon, 10 Dec 2012 15:07:46 +0000
-----------------

-----------------
Assigned to: Aleksey Yeschenko
-----------------

-----------------
Description: 

created CF with cli:
<div class="preformatted panel" style="border-width: 1px;"><div
class="preformattedContent panelContent"><pre>create column family playlistswith
key_validation_class = UUIDType and comparator = 'CompositeType(UTF8Type, UTF8Type,
UTF8Type)' and default_validation_class = UUIDType;</pre></div></div>
Then get this error
with cqlsh:
<div class="preformatted panel" style="border-width: 1px;"><div
class="preformattedContent panelContent"><pre>cqlsh:music&gt; describe table
playlists;/Users/jonathan/projects/cassandra/git-trunk/bin/../pylib/cqlshlib/cql3handling.py:771:
UnexpectedTableStructure: Unexpected table structure; may not translate correctly to CQL.
expected composite key CF to have column aliases, but found
none/Users/jonathan/projects/cassandra/git-trunk/bin/../pylib/cqlshlib/cql3handling.py:794:
UnexpectedTableStructure: Unexpected table structure; may not translate correctly to CQL.
expected [u'KEY'] length to be 3, but it's 1.
comparator='org.apache.cassandra.db.marshal.CompositeType(org.apache.cassandra.db.marshal.UTF8Type,org.apache.cassandra.db.marshal.UTF8Type,org.apache.cassandra.db.marshal.UTF8Type)'CREATE
TABLE playlists (  "KEY" uuid PRIMARY KEY)</pre></div></div> 

-----------------

-----------------
Comments: 

New Comment: 
Have only tested in 1.1 since <a
href="https://issues.apache.org/jira/browse/CASSANDRA-4823" title="Fix cqlsh after move of
CL to the protocol level" class="issue-link"
data-issue-key="CASSANDRA-4823"><del>CASSANDRA-4823</del></a> is not yet done for
trunk.Expected result would be<div class="code panel" style="border-width: 1px;"><div
class="codeContent panelContent"><pre class="code-java">CREATE TABLE playlists (  key
uuid,  column1 text,  column2 text,  column3 text,  column4 uuid  PRIMARY KEY (key,
column1, column2, column3)) WITH COMPACT STORAGE</pre></div></div>(See column name
"forging" in CFDefinition.) 


New Comment: 
cql3 on trunk:cqlsh:music&gt; describe table
playlists;/Users/aleksey/Repos/ASF/cassandra/bin/../pylib/cqlshlib/cql3handling.py:1505:
UnexpectedTableStructure: Unexpected table structure; may not translate correctly to CQL.
Dynamic storage CF does not have UTF8Type added to comparator 


New Comment: 
similar issue when trying to use COPY in cqlsh3. cf was created with
cli/opt/cassandra/apache-cassandra-1.1.6/bin/../pylib/cqlshlib/cql3handling.py:771:
UnexpectedTableStructure: Unexpected table structure; may not translate correctly to CQL.
expected composite key CF to have column aliases, but found
none<br/>/opt/cassandra/apache-cassandra-1.1.6/bin/../pylib/cqlshlib/cql3handling.py:794:
UnexpectedTableStructure: Unexpected table structure; may not translate correctly to CQL.
expected <span class="error">&#91;u&#39;KEY&#39;&#93;</span> length to be 3, but it's 1.
comparator='org.apache.cassandra.db.marshal.CompositeType(org.apache.cassandra.db.marshal.UTF8Type,org.apache.cassandra.db.marshal.UTF8Type,org.apache.cassandra.db.marshal.IntegerType)' 


New Comment: 
4827-1.2 eliminates most if not all DESCRIBE issues in 1.2, no matter what kind of table
we are dealing with. 


New Comment: 
Oh, and this only fixes DESCRIBE in CQL3 mode. Didn't bother with CQL2. 


New Comment: 
+1 


