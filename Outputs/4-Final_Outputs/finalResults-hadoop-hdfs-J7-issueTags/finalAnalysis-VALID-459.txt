Pattern changes caused by commit: 8407e62f7880669a8754436b1d79fff42975529d

From: Mediator-1
To:   Mediator-0


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-459.txt 

commit 8407e62f7880669a8754436b1d79fff42975529d
Author: Jakob Glen Homan <jghoman@apache.org>

    HDFS-921. Convert TestDFSClientRetries::testNotYetReplicatedErrors to Mockito. jghoman.



==================================
 Issue HDFS-921 Description 
=======================================

Project: Hadoop HDFS
-----------------

-----------------
Title: [HDFS-921] Convert TestDFSClientRetries::testNotYetReplicatedErrors to Mockito
-----------------

-----------------
Summary: Convert TestDFSClientRetries::testNotYetReplicatedErrors to Mockito
-----------------

-----------------
Issue type: Improvement
-----------------

-----------------
Current status: Closed
-----------------

-----------------
Created at: Tue, 26 Jan 2010 02:44:14 +0000
-----------------

-----------------
Resolved at: Mon, 26 Apr 2010 02:19:08 +0000
-----------------

-----------------
Assigned to: Jakob Homan
-----------------

-----------------
Description: 

When TestDFSClientRetries::testNotYetReplicatedErrors was written, Mockito was not
available and the NameNode was mocked by manually extending ClientProtocol and
implementing all the methods, most with empty bodies.  Now that we have Mockito, this code
can be removed and replaced with an actual mock.
 

-----------------

-----------------
Comments: 

New Comment: 
Attaching patch that removes the old, manually mocked Namenode and provides equivalent
functionality via Mockito. 


New Comment: 
submitting patch. 


New Comment: 
+1 patch looks good. It does eliminate about 140 lines of code and, which a more
important, reduces the execution time of the test from about 160 secs down to 70 odd!
Also, the code is a way more clean now. Great. One nit though (non-mandatory): I'd group
mockito.* related imports together, but it is a matter of personal taste. 


New Comment: 
+1 overall.  Here are the results of testing the latest attachment <br/>  <a
href="http://issues.apache.org/jira/secure/attachment/12431401/HDFS-921.patch"
class="external-link"
rel="nofollow">http://issues.apache.org/jira/secure/attachment/12431401/HDFS-921.patch</a><br/>
 against trunk revision 902330.    +1 @author.  The patch does not contain any @author
tags.    +1 tests included.  The patch appears to include 3 new or modified tests.    +1
javadoc.  The javadoc tool did not generate any warning messages.    +1 javac.  The
applied patch does not increase the total number of javac compiler warnings.    +1
findbugs.  The patch does not introduce any new Findbugs warnings.    +1 release audit. 
The applied patch does not increase the total number of release audit warnings.    +1 core
tests.  The patch passed core unit tests.    +1 contrib tests.  The patch passed contrib
unit tests.Test results: <a
href="http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/205/testReport/"
class="external-link"
rel="nofollow">http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/205/testReport/</a><br/>Findbugs
warnings: <a
href="http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/205/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html"
class="external-link"
rel="nofollow">http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/205/artifact/trunk/build/test/findbugs/newPatchFindbugsWarnings.html</a><br/>Checkstyle
results: <a
href="http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/205/artifact/trunk/build/test/checkstyle-errors.html"
class="external-link"
rel="nofollow">http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/205/artifact/trunk/build/test/checkstyle-errors.html</a><br/>Console
output: <a
href="http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/205/console"
class="external-link"
rel="nofollow">http://hudson.zones.apache.org/hudson/job/Hdfs-Patch-h5.grid.sp2.yahoo.net/205/console</a>This
message is automatically generated. 


New Comment: 
Patch went stale. Updated version. Uses new parameter to addBlock. Otherwise
unchanged.<br/>Cos: I'm a lazy, lazy man. I let Eclipse handle all my imports... <img
class="emoticon" src="https://issues.apache.org/jira/images/icons/emoticons/smile.png"
height="16" width="16" align="absmiddle" alt="" border="0"/> 


New Comment: 
Triggering Hudson on updated patch. 


New Comment: 
Hudson ran but didn't post:<div class="preformatted panel" style="border-width: 1px;"><div
class="preformattedContent panelContent"><pre>     [exec] -1 overall.  Here are the
results of testing the latest attachment      [exec]  
http://issues.apache.org/jira/secure/attachment/12442795/HDFS-921-2.patch     [exec]  
against trunk revision 937855.     [exec]      [exec]     +1 @author.  The patch does not
contain any @author tags.     [exec]      [exec]     +1 tests included.  The patch appears
to include 3 new or modified tests.     [exec]      [exec]     +1 javadoc.  The javadoc
tool did not generate any warning messages.     [exec]      [exec]     +1 javac.  The
applied patch does not increase the total number of javac compiler warnings.     [exec]   
  [exec]     +1 findbugs.  The patch does not introduce any new Findbugs warnings.    
[exec]      [exec]     +1 release audit.  The applied patch does not increase the total
number of release audit warnings.     [exec]      [exec]     +1 core tests.  The patch
passed core unit tests.     [exec]      [exec]     -1 contrib tests.  The patch failed
contrib unit tests.</pre></div></div>Contrib test failure is unrelated. 


New Comment: 
I've committed this. Resolving as fixed. 


New Comment: 
Handling imports automatically is a good thing: stale imports are being eliminated and all
that.<br/>Actually, I was about to suggest to move this test into src/test/unit because
now it looks like a real unit test. Shall I open a separate JIRA for that? What do you
think? 


New Comment: 
<blockquote>Actually, I was about to suggest to move this test into src/test/unit because
now it looks like a real unit test. Shall I open a separate JIRA for that? What do you
think?</blockquote>The src/test/unit directory is vexing. We should definitely have a JIRA
for moving those tests that can be truly called unit tests to it; I'm just afraid it'll be
a lonely little directory tree at the moment.  If we did, TestDFSClientRetries actually
probably wouldn't qualify because a new test that got added recently uses MiniDFSCluster
and takes more than a minute to run...  It's worth a JIRA though. 


