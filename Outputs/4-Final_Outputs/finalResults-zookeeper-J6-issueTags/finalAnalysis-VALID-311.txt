Pattern changes caused by commit: da1e988798fd0336a893e16e94d699e6b156c941

From: Facade-8
To:   Facade-7


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-311.txt 

commit da1e988798fd0336a893e16e94d699e6b156c941
Author: Patrick D. Hunt <phunt@apache.org>

    ZOOKEEPER-234. Eliminate using statics to initialize the sever. Should allow server to be more embeddable in OSGi enviorments.



==================================
 Issue ZOOKEEPER-234 Description 
=======================================

Project: ZooKeeper
-----------------

-----------------
Title: [ZOOKEEPER-234] Eliminate using statics to initialize the sever.  Should allow server to be more embeddable in OSGi enviorments.
-----------------

-----------------
Summary: Eliminate using statics to initialize the sever.  Should allow server to be more embeddable in OSGi enviorments.
-----------------

-----------------
Issue type: Improvement
-----------------

-----------------
Current status: Closed
-----------------

-----------------
Created at: Mon, 24 Nov 2008 21:01:29 +0000
-----------------

-----------------
Resolved at: Thu, 15 Jan 2009 22:59:50 +0000
-----------------

-----------------
Assigned to: Patrick D. Hunt
-----------------

-----------------
Description: 

Patrick request I open up this in issue in this <a
href="http://n2.nabble.com/ActiveMQ-is-now-using-ZooKeeper-td1573272.html"
class="external-link" rel="nofollow">email thread</a>

The main culprit I've noticed
is:
<div class="code panel" style="border-width: 1px;"><div class="codeContent
panelContent"><pre class="code-java">       
ServerStats.registerAsConcrete();</pre></div></div>
But there may be others.
 

-----------------

-----------------
Comments: 

New Comment: 
I like this, I'd like to see it in 3.1.0, if someone can submit a patch that would help to
ensure it's in 3.1.0. 


New Comment: 
Quick question : What is the approx time frame for 3.1.0 ? 


New Comment: 
Currently slated for jan19th, see the ZOOKEEPER project page, the "releases" link (in the
middle):<a
href="https://issues.apache.org/jira/browse/ZOOKEEPER?report=com.sourcelabs.jira.plugin.portlet.releases:releases-projecttab"
class="external-link"
rel="nofollow">https://issues.apache.org/jira/browse/ZOOKEEPER?report=com.sourcelabs.jira.plugin.portlet.releases:releases-projecttab</a>you
can also see it on the roadmap link on that same page. 


New Comment: 
step1 of the patch (see comment to follow on how to apply) 


New Comment: 
step 3 of the patch(see comment to follow on how to apply) 


New Comment: 
The attached patches will:<ul>	<li>remove the static stat classes</li>	<li>remove the
src/java/jmx subdir and integrate into the mainline</li>	<li>as a result all zookeeper
servers will now have jmx support by default</li>	<li>adds jmx support for log4j as
well</li>	<li>fixes a number of issues with the structure and data in jmx for zk
server(s)</li></ul>The two attached patches should be applied as follows:apply the first
patch "step 1"then:mkdir src/java/main/org/apache/zookeeper/jmx<br/>svn add
src/java/main/org/apache/zookeeper/jmx<br/>svn mv
src/java/jmx/org/apache/zookeeper/server/ManagedUtil.java
src/java/main/org/apache/zookeeper/jmx/.<br/>svn mv
src/java/jmx/org/apache/zookeeper/jmx/*.java
src/java/main/org/apache/zookeeper/jmx<br/>svn mv
src/java/jmx/org/apache/zookeeper/jmx/server/*.java
src/java/main/org/apache/zookeeper/server/.<br/>svn mv
src/java/jmx/org/apache/zookeeper/jmx/server/quorum/*.java
src/java/main/org/apache/zookeeper/server/quorum/.<br/>svn rm --force
src/java/jmxthen:apply second patch "step 3"after this process the src/java/jmx directory
should be no longerrun "ant test" to verify. also start a zkserver as follows and verify
that jconsole can connect:java -cp zookeeper-dev.jar:src/java/lib/log4j-1.2.15.jar:conf
-Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.local.only=false 
org.apache.zookeeper.server.quorum.QuorumPeerMain zoo.cfgthen: commit to svn if
tests/smoketest all pass 


New Comment: 
+1. I have followed the steps Patrick describes, omitting of course the commit step. I
have actually been able to connect using jconsole remotely, but in this case I had to use
more parameters. Here is the command I used:java -cp
.:./zookeeper-dev.jar:/usr/local/apache-log4j-1.2.15/log4j-1.2.15.jar
-Dlog4j.configuration=log4j_console.properties -Dcom.sun.management.jmxremote
-Dcom.sun.management.jmxremote.port=12122 -Dcom.sun.management.jmxremote.local.only=false
-Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.ssl=false
org.apache.zookeeper.server.quorum.QuorumPeerMain zoo.cfg I'll open a jira to document
these options upon Pat's request. 


New Comment: 
Committed revision 734847. 


