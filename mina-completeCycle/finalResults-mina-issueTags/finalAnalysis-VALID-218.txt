Pattern changes caused by commit: 9b353be9c76e2ec8946b0be30d78c94430400ed4

From: Facade-22
To:   Facade-23

From: Flyweight-19
To:   Flyweight-20

From: Mediator-65
To:   Mediator-67


=========================
       NEW GIT LOG
=========================

This commit refers to file: VALID-218.txt 

commit 9b353be9c76e2ec8946b0be30d78c94430400ed4
Author: Peter A Royal Jr <proyal@apache.org>

    DIRMINA-206 - Filter that watches the total amount queue'd for a connection in the ThreadPoolFilter and will disable reads for a connection when a configurable (default 1mb) limit is reached.



==================================
 Issue DIRMINA-206 Description 
=======================================

Project: MINA
-----------------

-----------------
Title: [DIRMINA-206] Prevent OutOfMemoryError when a server or a client is overloaded
-----------------

-----------------
Summary: Prevent OutOfMemoryError when a server or a client is overloaded
-----------------

-----------------
Issue type: Improvement
-----------------

-----------------
Current status: Closed
-----------------

-----------------
Created at: Wed, 12 Apr 2006 17:22:57 +0000
-----------------

-----------------
Resolved at: Tue, 26 Sep 2006 05:06:26 +0000
-----------------

-----------------
Assigned to: Peter A Royal Jr.
-----------------

-----------------
Description: 

MINA doesn't throttle read or write traffic even if a client or a server suffers from
bottleneck.  It will eventually cause the event buffer become full can throw an
OutOfMemoryError.  We need to prevent it.

Here's the related thread in our mailing
list:

<a
href="http://mail-archives.apache.org/mod_mbox/directory-mina-dev/200604.mbox/%3c44325244.2020109@falcom.de%3e"
class="external-link"
rel="nofollow">http://mail-archives.apache.org/mod_mbox/directory-mina-dev/200604.mbox/%3c44325244.2020109@falcom.de%3e</a>
 

-----------------

-----------------
Comments: 

New Comment: 
summarizing list thread:<ul>	<li>configure size of read buffer and automatically disable
reads once the buffer is full</li>	<li>buffer would be a filter that is inserted
<b>before</b> the ThreadPoolFilter</li>	<li>this eliminates the complexities of tracking
things in greater detail and all the goop from the thread pool</li>	<li>writes still tbd,
one thought is to block the write, but that has implications if no thread pool filter is
in use</li></ul> 


New Comment: 
I created a filter to throttle reads. The default per-connection 1mb buffer may/probably
is too large.. suggestions welcome.The filter wraps the ThreadPoolFilter (just adds itself
before + after) 


New Comment: 
I think 1 mega bytes are a little bit more than much.  Probably we could set it to about
the default socket read buffer size in Linux.  Perhaps with an extra room like 50%?  WDYT? 


New Comment: 
We still need to take care of write overflow and more convenient way to prevent
OutOfMemoryError, but Peter's patch at least solves the situation when the server is
overloaded.  I'd like to mark this issue as resolved and provide another issue for the
remaining problems. 


